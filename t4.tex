\section{Partial Differential Equations. Generalities on their solution}

\subsection{Finite differences}

\begin{example}[(1D Heat equation)]
  Our problem is:
  \[
    \begin{cases}
      U_t - U_{xx} = f\\
      U(x,0) = U_0(x) &\longleftarrow\text{Initial condition (IC)}\\
      \begin{rcases}
        U(a,t) = U_a \\
        U(b,t) = U_b
      \end{rcases} &\longleftarrow\text{Boundary conditions (BC)}\\
    \end{cases}
  \]
  
  With $t\geq 0, \, x\in[a,b]$
\end{example}

We discretize $x$ and $t$:

\begin{figure}[h]
    \centering
    \begin{tikzpicture}[scale=0.7pt,line cap=round,line join=round,>=triangle  45,x=0.9555555555555555cm,y=1.011764705882353cm]
        \begin{axis}[
        x=0.9555555555555555cm,y=1.011764705882353cm,
        axis lines=middle,
        xmin=-1,
        xmax=8.5,
        ymin=-1,
        ymax=8.0,
        xtick={-0.0},
        ytick={-0.0},]
        \clip(-1.0,-1.0) rectangle (8.5,8.5);
        \draw (0.1,-0.01492590769987644) node[anchor=north west] {$a$};
        \draw (6.936006015235138,-0.04625816247894026) node[anchor=north west] {$b$};
        \draw (-1.18,3.765832835640491) node[anchor=north west] {$\Delta t$};
        \draw (3.1,-0.20291943637425935) node[anchor=north west] {$\Delta x$};
        \draw (0.8575485880967675,-0.01492590769987644) node[anchor=north west] {$x_1$};
        \draw (1.839292571174099,-0.03581407755258566) node[anchor=north west] {$x_2$};
        \draw (-0.7,1.2592524533153857) node[anchor=north west] {$t^1$};
        \draw (-0.7,2.2723286911717824) node[anchor=north west] {$t^2$};
        \draw (8.074411272207788,-0.12981084188977712) node[anchor=north west] {$\boldsymbol{x}$};
        \draw (-0.49,8) node[anchor=north west] {$\boldsymbol{t}$};
        \draw [->,line width=1.pt] (-0.3346034577059823,3.8604740672051325) -- (-0.3346034577059823,3.1204740672051328);
        \draw [->,line width=1.pt] (-0.3346034577059823,3.7017839952482134) -- (-0.3329059840463152,3.8906629755388313);
        \draw [->,line width=1.pt] (3.121531540966689,-0.14907205546295046) -- (3.948030184929092,-0.14559937208495718);
        \draw [->,line width=1.pt] (3.823001199491475,-0.1461247039565438) -- (3.0069329894929098,-0.15254473884094374);
        \draw [line width=1.pt] (1.,0.) -- (1.,8.);
        \draw [line width=1.pt] (2.,0.) -- (2.,8.);
        \draw [line width=1.pt] (3.,0.) -- (3.,8.);
        \draw [line width=1.pt] (4.,0.) -- (4.,8.);
        \draw [line width=1.pt] (5.,0.) -- (5.,8.);
        \draw [line width=1.pt] (6.,0.) -- (6.,8.);
        \draw [line width=1.pt] (7.,0.) -- (7.,8.);
        \draw [line width=1.pt,domain=0.0:8.5] plot(\x,{(--7.-0.*\x)/7.});
        \draw [line width=1.pt,domain=0.0:8.5] plot(\x,{(--4.-0.*\x)/2.});
        \draw [line width=1.pt,domain=0.0:8.5] plot(\x,{(--3.-0.*\x)/1.});
        \draw [line width=1.pt,domain=0.0:8.5] plot(\x,{(--4.-0.*\x)/1.});
        \draw [line width=1.pt,domain=0.0:8.5] plot(\x,{(--5.-0.*\x)/1.});
        \draw [line width=1.pt,domain=0.0:8.5] plot(\x,{(--6.-0.*\x)/1.});
        \draw [line width=1.pt,domain=0.0:8.5] plot(\x,{(--7.-0.*\x)/1.});
        \begin{scriptsize}
        \draw [fill=black] (1.,0.) circle (1.5pt);
        \draw [fill=black] (2.,0.) circle (1.5pt);
        \draw [fill=black] (3.,0.) circle (1.5pt);
        \draw [fill=black] (4.,0.) circle (1.5pt);
        \draw [fill=black] (5.,0.) circle (1.5pt);
        \draw [fill=black] (6.,0.) circle (1.5pt);
        \draw [fill=black] (7.,0.) circle (1.5pt);
        \draw [fill=black] (0.,0.) circle (1.5pt);
        \draw [fill=black] (0.,1.) circle (1.5pt);
        \draw [fill=black] (0.,2.) circle (1.5pt);
        \draw [fill=black] (0.,3.) circle (1.5pt);
        \draw [fill=black] (0.,4.) circle (1.5pt);
        \draw [fill=black] (0.,5.) circle (1.5pt);
        \draw [fill=black] (0.,6.) circle (1.5pt);
        \draw [fill=black] (0.,7.) circle (1.5pt);
        \draw [fill=black] (1.,1.) circle (1.5pt);
        \draw [fill=black] (1.,2.) circle (1.5pt);
        \draw [fill=black] (1.,3.) circle (1.5pt);
        \draw [fill=black] (1.,4.) circle (1.5pt);
        \draw [fill=black] (1.,5.) circle (1.5pt);
        \draw [fill=black] (1.,6.) circle (1.5pt);
        \draw [fill=black] (1.,7.) circle (1.5pt);
        \draw [fill=black] (2.,1.) circle (1.5pt);
        \draw [fill=black] (3.,1.) circle (1.5pt);
        \draw [fill=black] (4.,1.) circle (1.5pt);
        \draw [fill=black] (5.,1.) circle (1.5pt);
        \draw [fill=black] (6.,1.) circle (1.5pt);
        \draw [fill=black] (7.,1.) circle (1.5pt);
        \draw [fill=black] (2.,2.) circle (1.5pt);
        \draw [fill=black] (3.,2.) circle (1.5pt);
        \draw [fill=black] (4.,2.) circle (1.5pt);
        \draw [fill=black] (2.,3.) circle (1.5pt);
        \draw [fill=black] (2.,4.) circle (1.5pt);
        \draw [fill=black] (2.,5.) circle (1.5pt);
        \draw [fill=black] (2.,6.) circle (1.5pt);
        \draw [fill=black] (2.,7.) circle (1.5pt);
        \draw [fill=black] (3.,3.) circle (1.5pt);
        \draw [fill=black] (3.,4.) circle (1.5pt);
        \draw [fill=black] (3.,5.) circle (1.5pt);
        \draw [fill=black] (3.,6.) circle (1.5pt);
        \draw [fill=black] (3.,7.) circle (1.5pt);
        \draw [fill=black] (4.,3.) circle (1.5pt);
        \draw [fill=black] (4.,4.) circle (1.5pt);
        \draw [fill=black] (4.,5.) circle (1.5pt);
        \draw [fill=black] (4.,6.) circle (1.5pt);
        \draw [fill=black] (4.,7.) circle (1.5pt);
        \draw [fill=black] (5.,2.) circle (1.5pt);
        \draw [fill=black] (5.,3.) circle (1.5pt);
        \draw [fill=black] (5.,4.) circle (1.5pt);
        \draw [fill=black] (5.,5.) circle (1.5pt);
        \draw [fill=black] (5.,6.) circle (1.5pt);
        \draw [fill=black] (5.,7.) circle (1.5pt);
        \draw [fill=black] (6.,2.) circle (1.5pt);
        \draw [fill=black] (6.,3.) circle (1.5pt);
        \draw [fill=black] (6.,4.) circle (1.5pt);
        \draw [fill=black] (6.,5.) circle (1.5pt);
        \draw [fill=black] (6.,6.) circle (1.5pt);
        \draw [fill=black] (6.,7.) circle (1.5pt);
        \draw [fill=black] (7.,2.) circle (1.5pt);
        \draw [fill=black] (7.,3.) circle (1.5pt);
        \draw [fill=black] (7.,4.) circle (1.5pt);
        \draw [fill=black] (7.,5.) circle (1.5pt);
        \draw [fill=black] (7.,6.) circle (1.5pt);
        \draw [fill=black] (7.,7.) circle (1.5pt);
        \end{scriptsize}
        \end{axis}
        \end{tikzpicture}
    %\caption{}
    %\label{fig:my_label}
\end{figure}

\-\\\underline{Idea}: We'll impose $U_t(x_i,t^n) - U_{xx}(x_i,t^n) = f(x_i,t^n)$

\newpage

\subsubsection{Numerical derivatives}

\definecolor{qqwwzz}{rgb}{0.,0.4,0.6}

\begin{figure}[h]
    \centering
    \begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=1.0cm,y=1.0cm]
    \begin{axis}[
    x=1.0cm,y=1.0cm,
    axis lines=middle,
    xmin=9.0,
    xmax=19.0,
    ymin=-1.0,
    ymax=7.0,
    xtick={0.0},
    ytick={0.0},y axis line style={draw = none}]
    \clip(9.,-1.) rectangle (19.,7.);
    \draw[line width=1.pt, smooth,samples=100,domain=0.0:0.11] plot[parametric] function{37.06*t**(3.0)+0.0*t**(2.0)+5.7*t+9.8,-38.54*t**(3.0)+0.0*t**(2.0)+7.51*t+3.02};
    \draw[line width=1.pt, smooth,samples=100,domain=0.11:0.15] plot[parametric] function{-52.47*t**(3.0)+28.91*t**(2.0)+2.59*t+9.91,39.61*t**(3.0)-25.24*t**(2.0)+10.22*t+2.92};
    \draw[line width=1.pt, smooth,samples=100,domain=0.15:0.24] plot[parametric] function{1.47*t**(3.0)+4.08*t**(2.0)+6.4*t+9.72,-18.89*t**(3.0)+1.69*t**(2.0)+6.09*t+3.13};
    \draw[line width=1.pt, smooth,samples=100,domain=0.24:0.3] plot[parametric] function{-13.11*t**(3.0)+14.44*t**(2.0)+3.95*t+9.91,9.63*t**(3.0)-18.57*t**(2.0)+10.89*t+2.76};
    \draw[line width=1.pt, smooth,samples=100,domain=0.3:0.35] plot[parametric] function{-7.62*t**(3.0)+9.58*t**(2.0)+5.38*t+9.77,-31.65*t**(3.0)+18.04*t**(2.0)+0.07*t+3.82};
    \draw[line width=1.pt, smooth,samples=100,domain=0.35:0.41] plot[parametric] function{-10.98*t**(3.0)+13.12*t**(2.0)+4.13*t+9.92,72.27*t**(3.0)-91.76*t**(2.0)+38.74*t-0.72};
    \draw[line width=1.pt, smooth,samples=100,domain=0.41:0.49] plot[parametric] function{3.59*t**(3.0)-4.8*t**(2.0)+11.48*t+8.91,47.73*t**(3.0)-61.58*t**(2.0)+26.37*t+0.97};
    \draw[line width=1.pt, smooth,samples=100,domain=0.49:0.57] plot[parametric] function{-20.86*t**(3.0)+30.92*t**(2.0)-5.91*t+11.73,40.31*t**(3.0)-50.75*t**(2.0)+21.09*t+1.83};
    \draw[line width=1.pt, smooth,samples=100,domain=0.57:0.62] plot[parametric] function{-10.43*t**(3.0)+13.18*t**(2.0)+4.14*t+9.84,-36.6*t**(3.0)+80.04*t**(2.0)-53.05*t+15.84};
    \draw[line width=1.pt, smooth,samples=100,domain=0.62:0.7] plot[parametric] function{28.35*t**(3.0)-59.13*t**(2.0)+49.1*t+0.52,-54.92*t**(3.0)+114.21*t**(2.0)-74.29*t+20.24};
    \draw[line width=1.pt, smooth,samples=100,domain=0.7:0.77] plot[parametric] function{-7.01*t**(3.0)+14.63*t**(2.0)-2.2*t+12.41,14.24*t**(3.0)-30.06*t**(2.0)+26.04*t-3.02};
    \draw[line width=1.pt, smooth,samples=100,domain=0.77:0.85] plot[parametric] function{36.51*t**(3.0)-85.69*t**(2.0)+74.89*t-7.34,-63.54*t**(3.0)+149.23*t**(2.0)-111.73*t+32.27};
    \draw[line width=1.pt, smooth,samples=100,domain=0.85:0.92] plot[parametric] function{-17.36*t**(3.0)+51.06*t**(2.0)-40.83*t+25.3,-8.72*t**(3.0)+10.06*t**(2.0)+6.03*t-0.95};
    \draw [line width=1.pt,dotted] (14.,0.)-- (13.99722993459645,4.732881120180119);
    \draw [line width=1.pt, >=latex, <->] (10.2,0.36)-- (13.6,0.36);
    \draw [line width=1.pt, >=latex, <->] (14.38,0.34)-- (17.88,0.34);
    \draw (11.76,1.06) node[anchor=north west] {$h$};
    \draw (15.9,1.04) node[anchor=north west] {$h$};
    \draw (9.52,0.) node[anchor=north west] {$x_{i-1}$};
    \draw (17.94,-0.04) node[anchor=north west] {$x_{i+1}$};
    \draw (13.84,0.) node[anchor=north west] {$x_{i}$};
    \draw (17.5,6.6) node[anchor=north west] {$f$};
    \draw (13,5.58) node[anchor=north west] {$f_i = f(x_i)$};
    \begin{scriptsize}
    \draw [color=qqwwzz] (14.,0.)-- ++(-1.5pt,0 pt) -- ++(3.0pt,0 pt) ++(-1.5pt,-1.5pt) -- ++(0 pt,3.0pt);
    \draw [fill=qqwwzz] (13.99722993459645,4.732881120180119) circle (1.5pt);
    \draw [color=black] (9.82,0.)-- ++(-1.5pt,0 pt) -- ++(3.0pt,0 pt) ++(-1.5pt,-1.5pt) -- ++(0 pt,3.0pt);
    \draw [color=black] (18.18,0.)-- ++(-1.5pt,0 pt) -- ++(3.0pt,0 pt) ++(-1.5pt,-1.5pt) -- ++(0 pt,3.0pt);
    \draw [fill=black,shift={(10.2,0.36)},rotate=90] (0,0) ++(0 pt,2.25pt) -- ++(1.9485571585149868pt,-3.375pt)--++(-3.8971143170299736pt,0 pt) -- ++(1.9485571585149868pt,3.375pt);
    \draw [fill=black,shift={(13.6,0.36)},rotate=270] (0,0) ++(0 pt,2.25pt) -- ++(1.9485571585149868pt,-3.375pt)--++(-3.8971143170299736pt,0 pt) -- ++(1.9485571585149868pt,3.375pt);
    \draw [fill=black,shift={(14.38,0.34)},rotate=90] (0,0) ++(0 pt,2.25pt) -- ++(1.9485571585149868pt,-3.375pt)--++(-3.8971143170299736pt,0 pt) -- ++(1.9485571585149868pt,3.375pt);
    \draw [fill=black,shift={(17.88,0.34)},rotate=270] (0,0) ++(0 pt,2.25pt) -- ++(1.9485571585149868pt,-3.375pt)--++(-3.8971143170299736pt,0 pt) -- ++(1.9485571585149868pt,3.375pt);
    \end{scriptsize}
    \end{axis}
    \end{tikzpicture}
    %\caption{}
    %\label{fig:my_label}
\end{figure}

